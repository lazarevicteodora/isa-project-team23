<div class="home-container">
  <nav class="navbar">
    <div class="navbar-brand">
      <h1>ğŸ¥ JutjubiÄ‡</h1>
    </div>
    <div class="navbar-menu">
      <!-- Show user info if logged in -->
      <span *ngIf="currentUser" class="user-greeting">
        Zdravo, {{ currentUser.firstName }}!
      </span>
      
      <!-- Show login/register buttons if NOT logged in -->
      <div *ngIf="!currentUser">
        <button class="btn btn-primary" routerLink="/login">Prijavi se</button>
        <button class="btn btn-secondary" routerLink="/register">Registruj se</button>
      </div>
      
      <!-- Show logout if logged in -->
      <button *ngIf="currentUser" class="btn btn-logout" (click)="logout()">Odjavi se</button>
      <button class="btn btn-upload-nav" routerLink="/upload">Postavi Video</button>

    </div>
  </nav>

  <div class="content">
    <!-- Loading -->
    <div *ngIf="loading" class="loading">
      <p>UÄitavanje...</p>
    </div>

    <!-- Error -->
    <div *ngIf="errorMessage && !loading" class="alert alert-error">
      {{ errorMessage }}
    </div>

    <!-- User info (only if logged in) -->
    <div *ngIf="currentUser && !loading" class="user-card">
      <h2>DobrodoÅ¡ao/la, {{ currentUser.firstName }} {{ currentUser.lastName }}! ğŸ‰</h2>
      
      <div class="user-info">
        <p><strong>Email:</strong> {{ currentUser.email }}</p>
        <p><strong>KorisniÄko ime:</strong> {{ currentUser.username }}</p>
        <p><strong>Adresa:</strong> {{ currentUser.address }}</p>
        <p><strong>Status:</strong> 
          <span class="badge" [class.badge-success]="currentUser.activated" [class.badge-warning]="!currentUser.activated">
            {{ currentUser.activated ? 'Aktiviran' : 'Neaktiviran' }}
          </span>
        </p>
        <p *ngIf="currentUser.roles && currentUser.roles.length > 0">
          <strong>Role:</strong> 
          <span *ngFor="let role of currentUser.roles" class="badge badge-info">
            {{ role.name }}
          </span>
        </p>
      </div>
    </div>

    <!-- Welcome message (for everyone) -->
    <div class="welcome-message" *ngIf="!loading">
      <h3>ğŸš€ DobrodoÅ¡li na JutjubiÄ‡ platformu!</h3>
      <p>Ovo je YouTube-like platforma za deljenje video sadrÅ¾aja.</p>
      <p><strong>Princip:</strong> BEZ REKLAMA - IKADA! ğŸ¯</p>
    </div>

    <!-- Videos (for everyone) -->
    <div *ngIf="videos.length === 0 && !loading">
      <p>Trenutno nema videa.</p>
    </div>

    <div class="video-list" *ngIf="videos.length > 0">
      <div class="video-card" *ngFor="let video of videos">
        <h3>{{ video.title }}</h3>
        <p>{{ video.description }}</p>

        <!-- Thumbnail -->
        <img 
          [src]="video.thumbnailUrl" 
          alt="Thumbnail" 
          width="200"
          (error)="onImgError($event)">

        <!-- Dugme za reprodukciju -->
        <button (click)="toggleVideo(video)">
          {{ video.showVideo ? 'Zaustavi' : 'Pusti' }}
        </button>

        <!-- Video element -->
        <video 
          *ngIf="video.showVideo" 
          width="400" 
          controls 
          autoplay>
          <source [src]="video.videoUrl" type="video/mp4">
          Vas pretrazivac ne podrzava video tag.
        </video>
      </div>
    </div>
  </div>
</div>